local is_big_file = function()
    -- ignore big files
    local max_filesize = 50 * 1024 -- 50 KB
    local ok, stats = pcall(vim.loop.fs_stat, vim.api.nvim_buf_get_name(0))
    return ok and stats and stats.size > max_filesize
end

return {
    -- {
    --     "nvim-treesitter/nvim-treesitter-textobjects",
    --     config = function()
    --         ---@diagnostic disable-next-line: missing-fields
    --         require("nvim-treesitter.configs").setup({
    --             textobjects = {
    --                 select = {
    --                     enable = true,
    --                     disable = is_big_file,
    --                     lookahead = true,
    --                     keymaps = {
    --                         ["af"] = "@function.outer",
    --                         ["if"] = "@function.inner",
    --                     },
    --                 },
    --             },
    --         })
    --     end,
    -- },
    {
        'nvim-treesitter/nvim-treesitter',
        lazy = false,
        branch = 'main',
        build = ':TSUpdate',
        config = function()
            require 'nvim-treesitter'.install { 'rust', 'javascript', 'zig' }
        end,

    },
    -- { -- Highlight, edit, and navigate code
    --     "nvim-treesitter/nvim-treesitter",
    --     branch = "main",
    --     build = ":TSUpdate",
    --     config = function()
    --         -- [[ Configure Treesitter ]] See `:help nvim-treesitter`
    --
    --         ---@diagnostic disable-next-line: missing-fields
    --         require("nvim-treesitter.configs").setup({
    --             -- A list of parser names, or "all"
    --             ensure_installed = { "javascript", "typescript", "c", "lua", "rust", "templ" },
    --
    --             -- Install parsers synchronously (only applied to `ensure_installed`)
    --             sync_install = false,
    --
    --             -- Automatically install missing parsers when entering buffer
    --             -- Recommendation: set to false if you don't have `tree-sitter` CLI installed locally
    --             auto_install = true,
    --             incremental_selection = {
    --                 enable = true,
    --                 disable = is_big_file,
    --                 keymaps = {
    --                     init_selection = "<c-space>",
    --                     node_incremental = "<c-space>",
    --                     scope_incremental = "<c-s>",
    --                     node_decremental = "<c-h>",
    --                 },
    --             },
    --
    --             highlight = {
    --                 -- `false` will disable the whole extension
    --                 enable = true,
    --                 disable = is_big_file,
    --                 -- Setting this to true will run `:h syntax` and tree-sitter at the same time.
    --                 -- Set this to `true` if you depend on 'syntax' being enabled (like for indentation).
    --                 -- Using this option may slow down your editor, and you may see some duplicate highlights.
    --                 -- Instead of true it can also be a list of languages
    --                 additional_vim_regex_highlighting = false,
    --             },
    --         })
    --         -- There are additional nvim-treesitter modules that you can use to interact
    --         -- with nvim-treesitter. You should go explore a few and see what interests you:
    --         --
    --         --    - Incremental selection: Included, see `:help nvim-treesitter-incremental-selection-mod`
    --         --    - Show your current context: https://github.com/nvim-treesitter/nvim-treesitter-context
    --         --    - Treesitter + textobjects: https://github.com/nvim-treesitter/nvim-treesitter-textobjects
    --     end,
    -- },
}
